sudo: required
dist: trusty
language: python
services:
- docker
env:
  global:
  - secure: zDcqckS5uPCKJGWxrHtai6t7lXZXnO6UzQQoRKRFG/IPK75YTNELzhK6IycXqCwthYHZQDS29q2PkojcrEF3Bz4vgY9gtqKKO4EVXKTYRs1FFb86Q4H6QEdT/EQrijpMcmPQJWZNfGbx4hIGwH8suLlpaVVGuoLqmj9lRH1BEZf2fIfj5Ky5vXfX3u4mxRHXLnxx6SbvC8dBT2cEv0F4UFkug9RmVKeUuGAZbe3WF5nPFkBpcXhQHlvvEep5S6LHiYuX6wVOdUTzX9azuM/lsED6gfPtqrx09aF5Rzm67GvZ2wj9qkDnWcx7XwKsGIn4l6LKAfFp2Kte89EHszWYhKbC+cPFggB8EidzCpGH//OjIzpNcpt+qNbydlaV4z72m0WahHcoyoCVmp0KlBqhiXgwcifDSYQ1TE8L/suTTiQywokXOJp0m+AWfObCYhI82q52T6hNITHcfFPaa3Zm2J6LjLuxFmndm0svWUNqBHXUafR4SryeqwCWBggCjM0+FUzUKl2g6Z1v7xtbddSeE1sNeRP2RUEEWYi6CqJxNJNpsf5aKFWQjH1nz35Dw19SYGri9VXuxXFqMQoy29dMjIO2/CisMY0hzX0+mGXzm14T+UdTVmO+1je7jK2COegaTIEnGVmF1dc1yvySHt203jJdyH6un8/9oRt4zJmh1kQ=
  - secure: zcXkYV29kcTY3elOeolGoII8l/iiVQk6eeP8BE/lPEiLwB49THsOWOdnrQPMpXueUmxEccJ/M4UsKxl4s3jzdFSb7lP69cZYDcRmJbyqVdjhQPKFQY1bLzSSMuhz/6CQ83BZ2vFOWtShGse9OQRDPCJq+Q5XwOiAWceoRucQucpszXKppW+OndF8ZVwk1JLP5Kb+PSWcXQRDqNgvNoj6xSRFhCszVu7zhsgbQN/wH5Je72/PlAroLTALHF0+wlCNio6zlOjRWDc/kJ5/80TaYUtQVM+2xE2euQtUb4gMnxOWm5n1q+GqNLtz2KM6KXe7d1+S2MZrA8XBCUrL32v4DhFUAB2SQp1Cj1cUB4tNffACWPOENqweUpx7SlTU6BAypYPfDjgklucdWbxk1J8WoGj+iyWNYiSepkTZO/im4qGMDwi17m3WUJzVa+BoczG+6D7Frdy1OlYxk2Uhkg8xAEFcv8S3OTRxZpYdaokKhQ2pzG8f36bEYTAyZUtr7Ef6k29Qg+IaZzzIaDA03R4dA0es8qimkGVl3egbz095cD0Wa1av6+6Q11oa43B6/bVcMJ8fAPYP30oiVbN04ruHphXVZRm06WSQSj8axj41oKlq16UgIJOj/jIR8rtVYipTM905IHxBd0LHq5lU8B6N9wLBTyTzztjxpaSjgcx8dqI=
  matrix:
  - COVERAGE="true" RUN_TESTS="true"
  - RUN_PYLINT="true"
  - RUN_MYPY="true"
  - BUILD_DOCS="true"
notifications:
  email: false
before_install:
- docker build -t allennlp/allennlp .
install:
script:
- docker run allennlp/allennlp /bin/bash -c "/stage/build_tools/travis/test_script.sh"
after_success:
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
    docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    docker push allennlp/allennlp-travis;
    fi
